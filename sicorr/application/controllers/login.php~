<?php
	
	class Login_controller extends Controller {
		
		var $view;

		public function __construct( )
		{
			parent::__construct( );
			$this->view = new View('wrapper');
			$this->session = Session::instance( );
		}

		/*----------------------------------*/
		public function index( )
		{
			$content = new View('login/index');
			$this->view->content = $content;
			$this->view->render(TRUE);
		}
		
		public function login( )
		{
			extract($_POST);
			$params = array('usuario'=>$usuario,'password'=>sha1($password));
			$user = ORM::factory('usuario');
			$user->where($params)->find( );
			if (!empty($user->usuario))
			{
				$this->session->create( );
				$this->session->set('user_id',$user->id);
				$this->session->set('grupo_id',$user->grupo_id);
				url::redirect('menu');
			}
			else 
			{
				url::redirect('login');
			}
		}
		/*------------------------------------*/
	}


// End Login
